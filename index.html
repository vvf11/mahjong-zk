<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–∞—Å—å—è–Ω—Å –ú–∞–¥–∂–æ–Ω–≥</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1400px;
            margin: 0 auto;
            padding: 10px;
            background-color: #0a4e2e;
            background-image: url('https://www.transparenttextures.com/patterns/bamboo-mat.png');
            overflow-x: hidden;
        }
        header {
            text-align: center;
            padding: 15px 0;
            color: white;
            margin-bottom: 20px;
        }
        header h1 {
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            font-size: 2.5em;
        }
        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #0a6e3c;
            background-image: url('https://www.transparenttextures.com/patterns/asfalt-light.png');
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            position: relative;
        }
        .game-info {
            display: flex;
            justify-content: space-between;
            width: 100%;
            color: white;
            margin-bottom: 15px;
            font-size: 18px;
        }
        .game-stats {
            display: flex;
            gap: 20px;
        }
        .board-container {
            position: relative;
            width: 100%;
            height: 600px;
            overflow: auto;
            background-color: #0a5e30;
            background-image: url('https://www.transparenttextures.com/patterns/felt.png');
            border-radius: 8px;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.3);
        }
        #game-board {
            position: relative;
            margin: 0 auto;
            width: max-content;
            min-width: 100%;
            min-height: 100%;
            padding: 20px;
        }
        .tile {
            position: absolute;
            width: 55px;
            height: 70px;
            background-color: #f8f8f8;
            border: 2px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s, box-shadow 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-weight: bold;
            user-select: none;
            background-image: linear-gradient(to bottom, #fff, #f0f0e8);
        }
        .tile:hover {
            transform: translateY(-5px);
            box-shadow: 2px 5px 10px rgba(0, 0, 0, 0.3);
        }
        .tile.selected {
            border-color: #ff5722;
            box-shadow: 0 0 15px #ff5722;
            transform: translateY(-8px);
        }
        .tile.disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        .tile.highlight {
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 8px #ffeb3b; }
            50% { box-shadow: 0 0 18px #ffeb3b; }
            100% { box-shadow: 0 0 8px #ffeb3b; }
        }
        .controls {
            margin-top: 20px;
            display: flex;
            gap: 15px;
        }
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            background-color: #4caf50;
            color: white;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.2);
        }
        button:hover {
            background-color: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
        }
        button:active {
            transform: translateY(1px);
            box-shadow: 0 2px 3px rgba(0, 0, 0, 0.2);
        }
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .game-menu {
            margin-top: 20px;
            width: 100%;
            max-width: 800px;
            text-align: center;
        }
        .layout-options {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }
        .layout-button {
            background-color: #3f51b5;
            background-image: linear-gradient(to bottom, #5c6bc0, #3f51b5);
            color: white;
            padding: 15px 25px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.2);
            font-weight: bold;
            font-size: 16px;
        }
        .layout-button:hover {
            background-color: #303f9f;
            background-image: linear-gradient(to bottom, #3f51b5, #303f9f);
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 100;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: white;
            background-image: url('https://www.transparenttextures.com/patterns/cream-paper.png');
            padding: 30px;
            border-radius: 8px;
            text-align: center;
            max-width: 500px;
            width: 80%;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
            animation: modal-appear 0.3s ease-out;
        }
        @keyframes modal-appear {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .modal h2 {
            margin-top: 0;
            color: #4caf50;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
        }
        .modal p {
            margin-bottom: 20px;
            font-size: 18px;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø–ª–∏—Ç–æ–∫ */
        .tile.character {
            background-color: #fffbf0;
            color: #d32f2f;
            background-image: linear-gradient(to bottom, #fffbf0, #f8e8c8);
            border-color: #d8c8a8;
        }
        .tile.bamboo {
            background-color: #f3ffe8;
            color: #2e7d32;
            background-image: linear-gradient(to bottom, #f3ffe8, #e0f0d0);
            border-color: #a8cf8e;
        }
        .tile.circle {
            background-color: #e8f5ff;
            color: #1565c0;
            background-image: linear-gradient(to bottom, #e8f5ff, #d0e8f0);
            border-color: #a0c8e8;
        }
        .tile.wind {
            background-color: #fff8e8;
            color: #bf6c24;
            background-image: linear-gradient(to bottom, #fff8e8, #f0e0c0);
            border-color: #e0c090;
        }
        .tile.dragon {
            background-color: #ffe8f0;
            color: #c2185b;
            background-image: linear-gradient(to bottom, #ffe8f0, #f0d0e0);
            border-color: #e0a0c0;
        }
        .tile.season {
            background-color: #f0fff0;
            color: #558b2f;
            background-image: linear-gradient(to bottom, #f0fff0, #e0f0e0);
            border-color: #a0d0a0;
        }
        .tile.flower {
            background-color: #f8e8ff;
            color: #7b1fa2;
            background-image: linear-gradient(to bottom, #f8e8ff, #e8d0f0);
            border-color: #d0a0e0;
        }
        
        /* –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
        .timer, .moves-counter, .tiles-left {
            font-weight: bold;
            text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.3);
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è —É–¥–∞–ª—è–µ–º—ã—Ö –ø–ª–∏—Ç–æ–∫ */
        @keyframes remove-tile {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
            100% { transform: scale(0); opacity: 0; }
        }
        .removing {
            animation: remove-tile 0.5s forwards;
        }
        
        /* –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º z-index –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–ª–æ–µ–≤ –ø–ª–∏—Ç–æ–∫ */
        .tile[data-z="0"] { z-index: 1; }
        .tile[data-z="1"] { z-index: 2; }
        .tile[data-z="2"] { z-index: 3; }
        .tile[data-z="3"] { z-index: 4; }
        .tile[data-z="4"] { z-index: 5; }
        
        /* –¢—Ä–µ—Ö–º–µ—Ä–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –¥–ª—è –ø–ª–∏—Ç–æ–∫ */
        .tile::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            box-sizing: border-box;
            border-top: 2px solid rgba(255, 255, 255, 0.7);
            border-left: 2px solid rgba(255, 255, 255, 0.7);
            border-right: 2px solid rgba(0, 0, 0, 0.1);
            border-bottom: 2px solid rgba(0, 0, 0, 0.1);
            border-radius: 3px;
            pointer-events: none;
        }
        
        /* –¢–µ–Ω—å –¥–ª—è –ø–ª–∏—Ç–æ–∫ */
        .tile::after {
            content: '';
            position: absolute;
            bottom: -6px;
            right: -6px;
            width: 55px;
            height: 70px;
            background-color: rgba(0, 0, 0, 0.15);
            border-radius: 5px;
            z-index: -1;
            transition: transform 0.2s;
        }
        
        /* –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ —Ç–µ–Ω—å —Ç–æ–∂–µ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è */
        .tile:hover::after {
            transform: translateY(-3px);
        }
        
        /* –û—Ç–∑—ã–≤—á–∏–≤—ã–π –¥–∏–∑–∞–π–Ω */
        @media (max-width: 768px) {
            .game-info {
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }
            .game-stats {
                flex-wrap: wrap;
                justify-content: center;
            }
            .board-container {
                height: 500px;
            }
            .controls {
                flex-wrap: wrap;
                justify-content: center;
            }
            .layout-options {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>üÄÑ –ü–∞—Å—å—è–Ω—Å –ú–∞–¥–∂–æ–Ω–≥</h1>
    </header>
    
    <div id="game-menu" class="game-menu">
        <h2 style="color: white; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞—Å–∫–ª–∞–¥–∫—É</h2>
        <div class="layout-options">
            <button class="layout-button" data-layout="classic">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è</button>
            <button class="layout-button" data-layout="turtle">–ß–µ—Ä–µ–ø–∞—Ö–∞</button>
            <button class="layout-button" data-layout="dragon">–î—Ä–∞–∫–æ–Ω</button>
        </div>
    </div>
    
    <div id="game-container" class="game-container" style="display:none;">
        <div class="game-info">
            <div>
                <span>–†–∞—Å–∫–ª–∞–¥–∫–∞: <span id="layout-name">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è</span></span>
            </div>
            <div class="game-stats">
                <div>–í—Ä–µ–º—è: <span id="timer" class="timer">00:00</span></div>
                <div>–•–æ–¥–æ–≤: <span id="moves" class="moves-counter">0</span></div>
                <div>–û—Å—Ç–∞–ª–æ—Å—å –ø–ª–∏—Ç–æ–∫: <span id="tiles-left" class="tiles-left">144</span></div>
            </div>
        </div>
        
        <div class="board-container">
            <div id="game-board"></div>
        </div>
        
        <div class="controls">
            <button id="hint-btn">–ü–æ–¥—Å–∫–∞–∑–∫–∞</button>
            <button id="shuffle-btn">–ü–µ—Ä–µ–º–µ—à–∞—Ç—å</button>
            <button id="undo-btn">–û—Ç–º–µ–Ω–∏—Ç—å —Ö–æ–¥</button>
            <button id="new-game-btn">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
        </div>
    </div>
    
    <div id="win-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <h2>–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏!</h2>
            <p>–í—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏ –∏–≥—Ä—É –∑–∞ <span id="final-time"></span> —Å <span id="final-moves"></span> —Ö–æ–¥–æ–≤.</p>
            <button id="play-again-btn">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
        </div>
    </div>
    
    <div id="no-moves-modal" class="modal" style="display:none;">
        <div class="modal-content">
            <h2>–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ö–æ–¥–æ–≤</h2>
            <p>–ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–∞—é—â–∏—Ö –ø–∞—Ä. –ü–ª–∏—Ç–∫–∏ –±—É–¥—É—Ç –ø–µ—Ä–µ–º–µ—à–∞–Ω—ã.</p>
            <button id="reshuffle-btn">–ü–µ—Ä–µ–º–µ—à–∞—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        </div>
    </div>
    
    <script src="game.js"></script>
    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let game = new MahjongSolitaire();
        let timerInterval;
        let startTime;
        
        // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è —Ä–∞–∑–º–µ—Ä–æ–≤ –ø–ª–∏—Ç–æ–∫ –∏ —Å–º–µ—â–µ–Ω–∏–π
        const TILE_WIDTH = 55;
        const TILE_HEIGHT = 70;
        const TILE_DEPTH = 4; // –í—ã—Å–æ—Ç–∞ –æ–¥–Ω–æ–≥–æ —Å–ª–æ—è
        
        // –°–∏–º–≤–æ–ª—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –ø–ª–∏—Ç–∫–∞—Ö
        const TILE_SYMBOLS = {
            Character: {
                1: '‰∏Ä', 2: '‰∫å', 3: '‰∏â', 4: 'Âõõ', 5: '‰∫î', 
                6: 'ÂÖ≠', 7: '‰∏É', 8: 'ÂÖ´', 9: '‰πù'
            },
            Bamboo: {
                1: 'üéç', 2: 'üéã', 3: 'üéç', 4: 'üéã', 5: 'üéç', 
                6: 'üéã', 7: 'üéç', 8: 'üéã', 9: 'üéç'
            },
            Circle: {
                1: '‚óè', 2: '‚óè', 3: '‚óè', 4: '‚óè', 5: '‚óè', 
                6: '‚óè', 7: '‚óè', 8: '‚óè', 9: '‚óè'
            },
            Wind: {
                East: 'Êù±', South: 'Âçó', West: 'Ë•ø', North: 'Âåó'
            },
            Dragon: {
                Red: '‰∏≠', Green: 'Áôº', White: 'ÁôΩ'
            },
            Season: {
                Spring: 'Êò•', Summer: 'Â§è', Autumn: 'Áßã', Winter: 'ÂÜ¨'
            },
            Flower: {
                Plum: 'Ê¢Ö', Orchid: 'Ëò≠', Chrysanthemum: 'Ëèä', Bamboo: 'Á´π'
            }
        };
        
        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const gameBoard = document.getElementById('game-board');
        const gameMenu = document.getElementById('game-menu');
        const gameContainer = document.getElementById('game-container');
        const timerEl = document.getElementById('timer');
        const movesEl = document.getElementById('moves');
        const tilesLeftEl = document.getElementById('tiles-left');
        const layoutNameEl = document.getElementById('layout-name');
        const winModal = document.getElementById('win-modal');
        const noMovesModal = document.getElementById('no-moves-modal');
        const finalTimeEl = document.getElementById('final-time');
        const finalMovesEl = document.getElementById('final-moves');
        
        // –ö–Ω–æ–ø–∫–∏
        const hintBtn = document.getElementById('hint-btn');
        const shuffleBtn = document.getElementById('shuffle-btn');
        const undoBtn = document.getElementById('undo-btn');
        const newGameBtn = document.getElementById('new-game-btn');
        const playAgainBtn = document.getElementById('play-again-btn');
        const reshuffleBtn = document.getElementById('reshuffle-btn');
        const layoutButtons = document.querySelectorAll('.layout-button');
        
        // –ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
        const selectSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3');
        const matchSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-game-ball-tap-2073.mp3');
        const winSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-achievement-bell-600.mp3');
        const hintSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-positive-interface-beep-221.mp3');
        const shuffleSound = new Audio('https://assets.mixkit.co/sfx/preview/mixkit-card-deck-shuffle-586.mp3');

        // –û—Ç–∫–ª—é—á–∞–µ–º –∑–≤—É–∫ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ–≥–æ –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª
        selectSound.volume = 0.3;
        matchSound.volume = 0.3;
        winSound.volume = 0.5;
        hintSound.volume = 0.3;
        shuffleSound.volume = 0.3;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame(layoutName) {
            // –û—á–∏—â–∞–µ–º –¥–æ—Å–∫—É
            gameBoard.innerHTML = '';
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–æ–≤—É—é –∏–≥—Ä—É
            const result = game.newGame(layoutName);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
            layoutNameEl.textContent = result.layout;
            tilesLeftEl.textContent = result.tilesLeft;
            movesEl.textContent = '0';
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–≥—Ä–æ–≤—É—é –¥–æ—Å–∫—É –∏ —Å–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é
            gameMenu.style.display = 'none';
            gameContainer.style.display = 'flex';
            
            // –†–µ–Ω–¥–µ—Ä–∏–º –¥–æ—Å–∫—É
            renderBoard();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
            startTime = Date.now();
            startTimer();
        }
        
        // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –¥–æ—Å–∫–∏
        function renderBoard() {
            const state = game.getGameState();
            const selectedTileId = state.selectedTile;
            
            // –û—á–∏—â–∞–µ–º –¥–æ—Å–∫—É
            gameBoard.innerHTML = '';
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–∞–∑–º–µ—Ä—ã –¥–æ—Å–∫–∏ –¥–ª—è —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
            const layout = game.layout;
            const boardWidth = (layout.width + 1) * TILE_WIDTH;
            const boardHeight = (layout.height + 1) * TILE_HEIGHT;
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä—ã –¥–æ—Å–∫–∏
            gameBoard.style.width = `${boardWidth}px`;
            gameBoard.style.height = `${boardHeight}px`;
            
            // –†–µ–Ω–¥–µ—Ä–∏–º –∫–∞–∂–¥—É—é –ø–ª–∏—Ç–∫—É
            state.board.forEach(tile => {
                const tileElement = document.createElement('div');
                tileElement.className = `tile ${tile.type.toLowerCase()}`;
                tileElement.dataset.id = tile.id;
                tileElement.dataset.z = tile.z;
                
                // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º –ø–ª–∏—Ç–∫—É —Å –Ω–µ–±–æ–ª—å—à–∏–º —Å–ª—É—á–∞–π–Ω—ã–º —Å–º–µ—â–µ–Ω–∏–µ–º –¥–ª—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç–∏
                const randomOffsetX = (Math.random() * 2 - 1) * 1;
                const randomOffsetY = (Math.random() * 2 - 1) * 1;
                tileElement.style.left = `${tile.x * TILE_WIDTH + randomOffsetX}px`;
                tileElement.style.top = `${tile.y * TILE_HEIGHT + randomOffsetY}px`;
                tileElement.style.transform = `translateZ(${tile.z * TILE_DEPTH}px) rotate(${(Math.random() * 2 - 1) * 0.5}deg)`;
                
                // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç/—Å–∏–º–≤–æ–ª –Ω–∞ –ø–ª–∏—Ç–∫—É
                let symbol = '';
                if (tile.type === TileType.Character || tile.type === TileType.Bamboo || tile.type === TileType.Circle) {
                    symbol = TILE_SYMBOLS[tile.type][tile.value];
                } else if (tile.type === TileType.Wind || tile.type === TileType.Dragon ||
                           tile.type === TileType.Season || tile.type === TileType.Flower) {
                    symbol = TILE_SYMBOLS[tile.type][tile.subtype];
                }
                tileElement.textContent = symbol;
                
                // –û—Ç–º–µ—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –ø–ª–∏—Ç–∫—É
                if (selectedTileId === tile.id) {
                    tileElement.classList.add('selected');
                }
                
                // –û—Ç–∫–ª—é—á–∞–µ–º –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø–ª–∏—Ç–∫–∏
                if (!tile.isFree) {
                    tileElement.classList.add('disabled');
                }
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
                tileElement.addEventListener('click', () => {
                    if (tile.isFree) {
                        selectSound.play();
                        selectTile(tile.id);
                    }
                });
                
                gameBoard.appendChild(tileElement);
            });
        }
        
        // –í—ã–±–æ—Ä –ø–ª–∏—Ç–∫–∏
        function selectTile(tileId) {
            const result = game.selectTile(tileId);
            
            if (result.success) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                renderBoard();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ —Ö–æ–¥–æ–≤ –∏ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –ø–ª–∏—Ç–∫–∏
                movesEl.textContent = game.getGameState().moves;
                tilesLeftEl.textContent = game.getGameState().tilesLeft;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ–π—Å—Ç–≤–∏—è
                if (result.action === 'match') {
                    matchSound.play();
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
                    if (result.gameOver) {
                        winSound.play();
                        endGame(result);
                    } else if (result.shouldReshuffle) {
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è
                        noMovesModal.style.display = 'flex';
                    }
                }
            }
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏
        function getHint() {
            const result = game.getHint();
            
            if (result.success) {
                hintSound.play();
                
                // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –ø–ª–∏—Ç–∫–∏
                const hintIds = result.hint;
                
                hintIds.forEach(id => {
                    const tileElement = document.querySelector(`.tile[data-id="${id}"]`);
                    if (tileElement) {
                        tileElement.classList.add('highlight');
                        
                        // –£–±–∏—Ä–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                        setTimeout(() => {
                            const el = document.querySelector(`.tile[data-id="${id}"]`);
                            if (el) {
                                el.classList.remove('highlight');
                            }
                        }, 3000);
                    }
                });
            } else {
                alert(result.message);
            }
        }
        
        // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ –ø–ª–∏—Ç–æ–∫
        function shuffleBoard() {
            shuffleSound.play();
            const result = game.shuffleBoard();
            
            if (result.success) {
                renderBoard();
            }
        }
        
        // –û—Ç–º–µ–Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Ö–æ–¥–∞
        function undoMove() {
            const result = game.undoMove();
            
            if (result.success) {
                renderBoard();
                movesEl.textContent = result.moves;
                tilesLeftEl.textContent = result.tilesLeft;
            } else {
                alert(result.message);
            }
        }
        
        // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
        function startTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            timerInterval = setInterval(() => {
                const elapsedSeconds = Math.floor((Date.now() - startTime) / 1000);
                const minutes = Math.floor(elapsedSeconds / 60);
                const seconds = elapsedSeconds % 60;
                timerEl.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }
        
        // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∞–π–º–µ—Ä–∞
        function stopTimer() {
            clearInterval(timerInterval);
        }
        
        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
        function endGame(result) {
            stopTimer();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
            const elapsedSeconds = Math.floor((Date.now() - startTime) / 1000);
            const minutes = Math.floor(elapsedSeconds / 60);
            const seconds = elapsedSeconds % 60;
            
            finalTimeEl.textContent = `${minutes} –º–∏–Ω. ${seconds} —Å–µ–∫.`;
            finalMovesEl.textContent = result.moves;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞
            setTimeout(() => {
                winModal.style.display = 'flex';
            }, 1000);
        }
        
        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        
        // –í—ã–±–æ—Ä —Ä–∞—Å–∫–ª–∞–¥–∫–∏
        layoutButtons.forEach(button => {
            button.addEventListener('click', (e) => {
                const layoutName = e.target.dataset.layout;
                initGame(layoutName);
            });
        });
        
        // –ö–Ω–æ–ø–∫–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∏
        hintBtn.addEventListener('click', getHint);
        
        // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è
        shuffleBtn.addEventListener('click', shuffleBoard);
        
        // –ö–Ω–æ–ø–∫–∞ –æ—Ç–º–µ–Ω—ã —Ö–æ–¥–∞
        undoBtn.addEventListener('click', undoMove);
        
        // –ö–Ω–æ–ø–∫–∞ –Ω–æ–≤–æ–π –∏–≥—Ä—ã
        newGameBtn.addEventListener('click', () => {
            stopTimer();
            gameContainer.style.display = 'none';
            gameMenu.style.display = 'block';
        });
        
        // –ö–Ω–æ–ø–∫–∞ "–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞" –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ –ø–æ–±–µ–¥—ã
        playAgainBtn.addEventListener('click', () => {
            winModal.style.display = 'none';
            gameContainer.style.display = 'none';
            gameMenu.style.display = 'block';
        });
        
        // –ö–Ω–æ–ø–∫–∞ "–ü–µ—Ä–µ–º–µ—à–∞—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å" –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Ö–æ–¥–æ–≤
        reshuffleBtn.addEventListener('click', () => {
            noMovesModal.style.display = 'none';
            shuffleBoard();
        });
    </script>
</body>
</html> 